# <div align="center"> MailSort.exe: Ваш надежный почтовый ассистент! </div>

<div align="center">
  <p>
    <b>Версия</b>: 3.2.1
  </p>
</div>

---

## Описание

MailSort.exe – это мощная утилита для автоматической сортировки писем в MS Outlook, разработанная командой KilocodE. Она поможет вам навести порядок в вашей электронной почте, автоматизируя рутинные задачи по сортировке и архивированию. 

Наша утилита не просто инструмент, это ваш личный почтовый ассистент, который работает незаметно и эффективно, освобождая ваше время для более важных дел. Мы в KilocodE стремимся к тому, чтобы наши программы были не только функциональными, но и удобными в использовании.

## Основные возможности:

- **Автоматическая сортировка писем:**
    - Интеллектуальное перемещение новых писем из папки "Входящие" в структурированные подпапки в папке "Темы" на основе правил, определенных в конфигурационных INI-файлах.
    - Поддержка сортировки по нескольким условиям:
        - Отправитель
        - Ключевые слова в тексте письма
        - Частичное совпадение темы письма
    - Автоматическое создание новых папок, если требуемая папка еще не существует.
    - Ограничение длины имени создаваемой папки для лучшей организации.
- **Интеллектуальное объединение похожих папок:**
    - Слияние папок с похожими именами в папках "Темы" и "Архив", что способствует лучшей организации вашей почты.
    - Настраиваемый порог схожести имен папок, позволяющий точно настроить процесс объединения.
    - Возможность исключения определенных папок из процесса объединения.
    - Автоматическое перемещение писем из объединяемых папок в целевую.
    - Удаление пустых исходных папок после слияния, что поддерживает порядок.
- **Умная архивация прочитанных писем:**
    - Автоматическое перемещение папок, где все письма прочитаны, из папки "Темы" в папку "Архив".
    - Возможность исключения определенных папок из процесса архивации.
- **Архивация по дате:**
    - Перемещение папок из папки "Архив" в подпапки, структурированные по годам, месяцам и неделям (год/месяц/неделя), используя дату получения первого письма в папке.
    - Если в папке нет писем, используется текущая дата, обеспечивая логическую организацию архива.
- **Восстановление папок из архива:**
    - Автоматическое перемещение папок с непрочитанными письмами из папки "Архив" обратно в папку "Темы", гарантируя, что важные сообщения не будут забыты.
- **Автоматическая очистка пустых папок:**
    - Удаление пустых папок (без писем и подпапок) в папках "Темы" и "Архив", что помогает поддерживать чистоту почтового ящика.
    - Исключение определенных папок из процесса удаления, предоставляя гибкость в управлении вашими папками.
- **Гибкая настройка через INI файлы:**
    - Вся конфигурация утилиты хранится в INI файлах, что позволяет вам легко настроить работу MailSort.exe под свои нужды.
- **Подробное логирование:**
    - Ведение журнала всех действий утилиты в файле `mailsort_log.txt` с подробными записями о перемещении писем и возникших ошибках.
    - Настройка размера лог-файла, что дает возможность контролировать объем хранимых данных.
    - Поддержка вывода сообщений в консоль для отслеживания работы в режиме реального времени.
- **Лицензирование:**
    -  Расширенный функционал:  удаление пустых папок, архивация, объединение, восстановление папок  доступен только при наличии лицензии (key-файл).

## Управление из командной строки

MailSort.exe поддерживает следующие аргументы командной строки:

- `-inst`: Первый запуск. Создает INI-файлы, key-файл и BAT-файл для запуска по расписанию.
- `-key`: Создает key-файл (пробный).
- `-ini`: Создает INI-файлы.
- `-bat`: Создает BAT-файл для запуска по расписанию.
- `-start`: Добавляет задание в планировщик задач Windows для запуска каждые 30 минут.
- `-stop`: Удаляет задание из планировщика задач Windows.
- `-info`: Выводит справочную информацию в файл.
- `-help`: Выводит справку по использованию.

## Как начать

1. **Скачайте** исполняемый файл `MailSort.exe`.
2.  **Первый запуск:** Запустите `MailSort.exe -inst`. Утилита создаст необходимые INI-файлы, key-файл и BAT-файл для дальнейшей работы.
3.  **Настройте INI-файлы:** Откройте `mailsort.ini` и `mailsort_rules.ini` и отредактируйте параметры под свои потребности.
4.  **Запуск вручную:** Запустите `MailSort.exe` без аргументов для однократной сортировки.
5.  **Запуск по расписанию:** Запустите `mailsort_start.bat` для автоматического запуска утилиты каждые 30 минут.
    -  Для автоматизации с помощью планировщика заданий:
         1.  Запустите `MailSort.exe -start` для добавления задания в планировщик задач.

## Файлы конфигурации

-   `mailsort.ini`: Содержит основные настройки утилиты, включая пути к файлам, параметры сортировки и архивирования.
-   `mailsort_rules.ini`: Определяет правила сортировки писем, включая ключевые слова для поиска в темах и телах писем.
- `mailsort_log.txt`: Лог-файл, в котором утилита записывает свои действия и возможные ошибки.
- `readme.txt`: Содержит справочную информацию об утилите.
- `.key`: Файл лицензии.

## Обратная связь

Если у вас возникли вопросы или предложения, пожалуйста, свяжитесь с нами по адресу: [KilocodE@yandex.ru](mailto:KilocodE@yandex.ru).

---
   <b>Спасибо за выбор MailSort.exe!</b>
